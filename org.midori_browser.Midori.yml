app-id: org.midori_browser.Midori

runtime: org.gnome.Platform
runtime-version: "3.32"
sdk: org.gnome.Sdk

command: midori

finish-args:
  # X11/Wayland
  - --socket=x11
  - --share=ipc
  - --socket=wayland
  - --device=dri
  # Sound
  - --socket=pulseaudio
  # Sync
  - --share=network
  # Filesystem access
  - --filesystem=host
  # Allow access to keyring
  - --talk-name=org.freedesktop.secrets
  # SSH
  - --socket=ssh-auth
  - --own-name=org.KDE.*
  # Other
  - --filesystem=xdg-download:rw
  - --talk-name=org.freedesktop.Notifications
  - --system-talk-name=org.freedesktop.GeoClue2

modules:
  #- dependencies/openssl.json
  #- dependencies/openssh.json
  #- dependencies/libfuse.json

  - name: libpeas
    sources:
        - type: git
          url: https://gitlab.gnome.org/GNOME/libpeas.git
          tag: libpeas-1.22.0

  - name: midori
    buildsystem: cmake-ninja
    builddir: true
    sources:
        - type: git
          url: https://github.com/midori-browser/core.git
          tag: v8.0
    
    cleanup:
      - /bin/
      - /lib/peas-demo
    sources:
        - type: git
          url: https://raw.githubusercontent.com/liberodark/flathub/com.termius.termius/org.midori_browser.Midori.appdata.xml
          sha256: 5f3b164b364b1fbc15cf228266c0f3872f8d28c21350a613daec6e2a52f14375

        #- type: file
        #  url: https://raw.githubusercontent.com/liberodark/flathub/com.termius.termius/org.midori_browser.Midori.desktop
        #  sha256: 5dbc21ec5c4c960a7760cae7ada3099e68d0eb03a722ae428d7edb959ceffd05
